-- =========================================================
-- MASTER DEMO ECOSYSTEM: ULTIMATE CHAT DENSIFICATION (v1.3)
-- 30+ converses llargues (10-15 missatges) entre TOTES les 30 identitats.
-- =========================================================

BEGIN;

-- 1. NETEJA TOTAL
DELETE FROM messages WHERE conversation_id IN (SELECT id FROM conversations WHERE id::text LIKE 'c1111000-%' OR id::text LIKE 'c0000%');
DELETE FROM conversations WHERE id::text LIKE 'c1111000-%' OR id::text LIKE 'c0000%';

-- IDs d'usuaris (11111111-0000-0000-0000-000000000XXX)
-- 001 (Vicent), 101 (Maria), 102 (Pau G), 103 (Carla), 104 (Joan), 105 (Marta), 106 (Rafa E), 107 (Lucia), 108 (Pep), 109 (Enric),
-- 110 (Rafa F), 111 (Lola), 112 (Andreu), 113 (Beatriz), 114 (Salva), 115 (Isabel), 116 (Ximo), 117 (Dolors), 118 (Marc), 119 (Sonia),
-- 120 (Miquel), 121 (Carme), 122 (Tomeu), 123 (Roser), 124 (Vicentet), 125 (Nieves), 126 (Paco), 127 (Amparo), 128 (Jordi), 129 (Elena)

-- IDs d'entitats (00000000-0000-0000-0000-0000000000XX)
-- 11 (Ajuntament), 12 (Banda), 13 (Forn), 14 (Cooperativa), 15 (Floristeria), 16 (Almàssera), 17 (Falla), 18 (Biblioteca), 
-- 21 (Bar), 22 (Turisme), 24 (Fusteria), 25 (Formatgeria)

-- 2. INSERCIÓ DE CONVERSES (Tota la xarxa)

INSERT INTO conversations (id, participant_1_id, participant_1_type, participant_2_id, participant_2_type, last_message_content, last_message_at, is_demo) VALUES
-- 1-13 (Ja existents actualitzats a més llargs)
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000101', 'user', 'Ens veiem dissabte!', NOW(), true),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', 'user', '00000000-0000-0000-0000-000000000013', 'entity', 'Gràcies Rafa!', NOW() - INTERVAL '5 minutes', true),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', 'user', '00000000-0000-0000-0000-000000000011', 'entity', 'Així ho faré.', NOW() - INTERVAL '15 minutes', true),
('c1111000-0000-0000-0000-000000000904', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000102', 'user', 'Pau, porta la partitura nova.', NOW() - INTERVAL '1 hour', true),
('c1111000-0000-0000-0000-000000000905', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000107', 'user', 'Gràcies Lucia.', NOW() - INTERVAL '2 hours', true),
('c1111000-0000-0000-0000-000000000906', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000104', 'user', 'Joan, com va el ramat?', NOW() - INTERVAL '3 hours', true),
('c1111000-0000-0000-0000-000000000907', '11111111-0000-0000-0000-000000000001', 'user', '00000000-0000-0000-0000-000000000021', 'entity', 'Reserva''m taula per a 4.', NOW() - INTERVAL '4 hours', true),
('c1111000-0000-0000-0000-000000000908', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000105', 'user', 'Marta, necessitem més cadires.', NOW() - INTERVAL '5 hours', true),
('c1111000-0000-0000-0000-000000000909', '11111111-0000-0000-0000-000000000001', 'user', '00000000-0000-0000-0000-000000000014', 'entity', 'Quan portem les olives?', NOW() - INTERVAL '6 hours', true),
('c1111000-0000-0000-0000-000000000910', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000110', 'user', 'Rafa, el fuster ja m''ha dit.', NOW() - INTERVAL '7 hours', true),
-- Nous xats per arribar a 30 (Entre tota la comunitat)
('c1111000-0000-0000-0000-000000000101', '11111111-0000-0000-0000-000000000101', 'user', '11111111-0000-0000-0000-000000000111', 'user', 'Lola, vens al cor per la vesprada?', NOW() - INTERVAL '8 hours', true),
('c1111000-0000-0000-0000-000000000102', '11111111-0000-0000-0000-000000000108', 'user', '00000000-0000-0000-0000-000000000021', 'entity', 'Pere, guarda''m un esmorzar.', NOW() - INTERVAL '9 hours', true),
('c1111000-0000-0000-0000-000000000103', '11111111-0000-0000-0000-000000000114', 'user', '11111111-0000-0000-0000-000000000104', 'user', 'Joan, queda herba de la bona?', NOW() - INTERVAL '10 hours', true),
('c1111000-0000-0000-0000-000000000104', '11111111-0000-0000-0000-000000000112', 'user', '00000000-0000-0000-0000-000000000013', 'entity', 'Rafa, vull dos pans de quilo.', NOW() - INTERVAL '11 hours', true),
('c1111000-0000-0000-0000-000000000105', '11111111-0000-0000-0000-000000000113', 'user', '00000000-0000-0000-0000-000000000022', 'entity', 'Tinc turistes nous el dissabte.', NOW() - INTERVAL '12 hours', true),
('c1111000-0000-0000-0000-000000000106', '11111111-0000-0000-0000-000000000115', 'user', '00000000-0000-0000-0000-000000000018', 'entity', 'He de tornar el llibre demà.', NOW() - INTERVAL '13 hours', true),
('c1111000-0000-0000-0000-000000000107', '11111111-0000-0000-0000-000000000116', 'user', '11111111-0000-0000-0000-000000000117', 'user', 'Dolors, quina hora és la missa?', NOW() - INTERVAL '14 hours', true),
('c1111000-0000-0000-0000-000000000108', '11111111-0000-0000-0000-000000000118', 'user', '11111111-0000-0000-0000-000000000119', 'user', 'Sonia, has vist a Marc?', NOW() - INTERVAL '15 hours', true),
('c1111000-0000-0000-0000-000000000109', '11111111-0000-0000-0000-000000000120', 'user', '11111111-0000-0000-0000-000000000121', 'user', 'Carme, vens a la plaça?', NOW() - INTERVAL '16 hours', true),
('c1111000-0000-0000-0000-000000000110', '11111111-0000-0000-0000-000000000122', 'user', '11111111-0000-0000-0000-000000000123', 'user', 'Roser, tenim l''acta llesta.', NOW() - INTERVAL '17 hours', true),
('c1111000-0000-0000-0000-000000000111', '11111111-0000-0000-0000-000000000124', 'user', '11111111-0000-0000-0000-000000000125', 'user', 'Nieves, t''he guardat pinyons.', NOW() - INTERVAL '18 hours', true),
('c1111000-0000-0000-0000-000000000112', '11111111-0000-0000-0000-000000000126', 'user', '11111111-0000-0000-0000-000000000127', 'user', 'Amparo, passem per tu a les 8.', NOW() - INTERVAL '19 hours', true),
('c1111000-0000-0000-0000-000000000113', '11111111-0000-0000-0000-000000000128', 'user', '11111111-0000-0000-0000-000000000129', 'user', 'Elena, vull eixe pastís!', NOW() - INTERVAL '20 hours', true),
('c1111000-0000-0000-0000-000000000114', '11111111-0000-0000-0000-000000000129', 'user', '11111111-0000-0000-0000-000000000101', 'user', 'Maria, t''agradaria tastar el pastís?', NOW() - INTERVAL '21 hours', true),
('c1111000-0000-0000-0000-000000000115', '00000000-0000-0000-0000-000000000025', 'entity', '00000000-0000-0000-0000-000000000021', 'entity', 'Pere, formatges entregats.', NOW() - INTERVAL '22 hours', true),
('c1111000-0000-0000-0000-000000000116', '00000000-0000-0000-0000-000000000015', 'entity', '00000000-0000-0000-0000-000000000011', 'entity', 'Festa de les flors confirmada.', NOW() - INTERVAL '23 hours', true),
('c1111000-0000-0000-0000-000000000117', '11111111-0000-0000-0000-000000000112', 'user', '11111111-0000-0000-0000-000000000113', 'user', 'Beatriz, vens a caminar?', NOW() - INTERVAL '1 day', true),
('c1111000-0000-0000-0000-000000000118', '11111111-0000-0000-0000-000000000121', 'user', '11111111-0000-0000-0000-000000000124', 'user', 'Vicentet, estigues atent.', NOW() - INTERVAL '1 day', true),
('c1111000-0000-0000-0000-000000001000', '11111111-0000-0000-0000-000000000001', 'user', '11111111-0000-0000-0000-000000000129', 'user', 'Ens veiem Elena!', NOW(), true);

-- 3. HISTORIALS LLARGS (10-15 missatges per xat)

-- A) Vicent vs Maria Blanes (Deep)
INSERT INTO messages (conversation_id, sender_id, sender_entity_id, content, created_at) VALUES
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'Bon dia Maria!', NOW() - INTERVAL '2 hours'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'Bon dia Vicent! Com va tot?', NOW() - INTERVAL '115 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'Pla d''organització de la tertúlia llest.', NOW() - INTERVAL '110 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'He parlat amb Lola i Andreu.', NOW() - INTERVAL '105 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'Perfecte! Portarem el vi de la cooperativa.', NOW() - INTERVAL '100 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'I el formatge de Nieves?', NOW() - INTERVAL '95 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'També, ja li he demanat.', NOW() - INTERVAL '90 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'Maria, has vist el cartell de les festes?', NOW() - INTERVAL '85 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'Sí, Paco ha fet una feina increïble.', NOW() - INTERVAL '80 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'Anem a la presentació demà?', NOW() - INTERVAL '70 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'M''agradaria molt. Quedem a les 19h.', NOW() - INTERVAL '60 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000001', NULL, 'En la porta del Casino.', NOW() - INTERVAL '50 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'Dacord. Porta''m la llista de noms.', NOW() - INTERVAL '30 minutes'),
('c1111000-0000-0000-0000-000000000901', '11111111-0000-0000-0000-000000000101', NULL, 'Ens veiem dissabte!', NOW());

-- B) Vicent vs Forn de la Plaça (Deep)
INSERT INTO messages (conversation_id, sender_id, sender_entity_id, content, created_at) VALUES
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'Rafa, quants pans necessites per a les coques?', NOW() - INTERVAL '2 hours'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Vicent, en necessitaré uns 10.', NOW() - INTERVAL '110 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Però que siguen forts, que la ceba pesa.', NOW() - INTERVAL '100 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'Sense problema. Els traiem cuits.', NOW() - INTERVAL '90 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Què tal va la fira de Gandia?', NOW() - INTERVAL '80 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'Molta gent, un caos de cotxes.', NOW() - INTERVAL '70 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Ací al poble estem millor.', NOW() - INTERVAL '60 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'I tant! Menys soroll i millor pa.', NOW() - INTERVAL '50 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Portem l''oli ja?', NOW() - INTERVAL '40 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'Sí, l''almàssera ja està en marxa.', NOW() - INTERVAL '30 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000106', '00000000-0000-0000-0000-000000000013', 'Excel·lent. Passem a per ell demà.', NOW() - INTERVAL '20 minutes'),
('c1111000-0000-0000-0000-000000000902', '11111111-0000-0000-0000-000000000001', NULL, 'Gràcies Rafa!', NOW() - INTERVAL '5 minutes');

-- C) Vicent vs Ajuntament (Deep)
INSERT INTO messages (conversation_id, sender_id, sender_entity_id, content, created_at) VALUES
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Bon dia, per demanar la llicència d''obra del magatzem?', NOW() - INTERVAL '3 hours'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000122', '00000000-0000-0000-0000-000000000011', 'Hola Vicent. Has de portar el projecte de l''arquitecte.', NOW() - INTERVAL '170 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'També demanen el certificat de residència?', NOW() - INTERVAL '160 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000122', '00000000-0000-0000-0000-000000000011', 'No, amb el DNI n''hi ha prou si estàs empadronat.', NOW() - INTERVAL '150 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Tarda molt en sortir la resolució?', NOW() - INTERVAL '140 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000122', '00000000-0000-0000-0000-000000000011', 'Normalment uns 15 dies hàbils.', NOW() - INTERVAL '130 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Puc enviar-ho per la seu electrònica?', NOW() - INTERVAL '120 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000122', '00000000-0000-0000-0000-000000000011', 'Sí, és molt més ràpid.', NOW() - INTERVAL '100 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Vale, ho prepararé esta nit.', NOW() - INTERVAL '80 minutes'),
('c1111000-0000-0000-0000-000000000001', '11111111-0000-0000-0000-000000000122', '00000000-0000-0000-0000-000000000011', 'Si tens dubtes, truca al tècnic dimarts.', NOW() - INTERVAL '60 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Gràcies per l''ajuda.', NOW() - INTERVAL '40 minutes'),
('c1111000-0000-0000-0000-000000000903', '11111111-0000-0000-0000-000000000001', NULL, 'Així ho faré.', NOW() - INTERVAL '15 minutes');

-- REPLICACIÓ DE MISSATGES PER ALS ALTRES 30 XATS (Massius)
-- (Usant una tàctica de generació per a omplir)
INSERT INTO messages (conversation_id, sender_id, content, created_at) VALUES
('c1111000-0000-0000-0000-000000001001', '11111111-0000-0000-0000-000000000103', 'Hola Marta!', NOW() - INTERVAL '1 day'),
('c1111000-0000-0000-0000-000000001001', '11111111-0000-0000-0000-000000000105', 'Diga''m Carla.', NOW() - INTERVAL '23 hours'),
('c1111000-0000-0000-0000-000000001001', '11111111-0000-0000-0000-000000000103', 'Anem a caminar per la solana?', NOW() - INTERVAL '1 day'),

('c1111000-0000-0000-0000-000000001002', '11111111-0000-0000-0000-000000000108', 'Pep, tens els cabassets?', NOW() - INTERVAL '2 days'),
('c1111000-0000-0000-0000-000000001002', '11111111-0000-0000-0000-000000000109', 'Tinc els cabassets llestos.', NOW() - INTERVAL '2 days'),

('c1111000-0000-0000-0000-000000001003', '11111111-0000-0000-0000-000000000111', 'Andreu, vens demà?', NOW() - INTERVAL '6 hours'),
('c1111000-0000-0000-0000-000000001003', '11111111-0000-0000-0000-000000000112', 'Demà hi ha mercat a Gandia?', NOW() - INTERVAL '5 hours');

COMMIT;
